"""
Advanced Tagging Script for Wine Intelligence Elite.
Updates tags based on specific varieties found in wine names.
"""

import sqlite3

DB_NAME = 'wines.db'


def advanced_tagging():
    conn = sqlite3.connect(DB_NAME)
    cursor = conn.cursor()

    # Î›Î•ÎÎ™ÎšÎŸ Î ÎŸÎ™ÎšÎ™Î›Î™Î©Î (Sommelier Logic)
    # Î¨Î¬Ï‡Î½Î¿Ï…Î¼Îµ Ï„Î· Î»Î­Î¾Î·-ÎºÎ»ÎµÎ¹Î´Î¯ (Î±ÏÎ¹ÏƒÏ„ÎµÏÎ¬) ÎºÎ±Î¹ Î²Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î± tags (Î´ÎµÎ¾Î¹Î¬)
    smart_rules = {
        # --- Î•Î¡Î¥Î˜Î¡Î‘ ---
        "ÎÎ¹Î½ÏŒÎ¼Î±Ï…ÏÎ¿": "ğŸ— Î‘Î³ÏÎ¹Î¿Î³Î¿ÏÏÎ¿Ï…Î½Î¿, ğŸ„ Î¡Î¹Î¶ÏŒÏ„Î¿ ÎœÎ±Î½Î¹Ï„Î±ÏÎ¹ÏÎ½, ğŸ– ÎšÏ…Î½Î®Î³Î¹",
        "ÎÎ¬Î¿Ï…ÏƒÎ±": "ğŸ— Î‘Î³ÏÎ¹Î¿Î³Î¿ÏÏÎ¿Ï…Î½Î¿, ğŸ„ Î¡Î¹Î¶ÏŒÏ„Î¿ ÎœÎ±Î½Î¹Ï„Î±ÏÎ¹ÏÎ½, ğŸ– ÎšÏ…Î½Î®Î³Î¹",
        "Î‘Î³Î¹Ï‰ÏÎ³Î¯Ï„Î¹ÎºÎ¿": "ğŸ¥˜ ÎšÎ¿ÎºÎºÎ¹Î½Î¹ÏƒÏ„ÏŒ, ğŸ” Burger, ğŸ ÎœÎ±ÎºÎ±ÏÏŒÎ½Î¹Î± Î¼Îµ ÎºÎ¹Î¼Î¬",
        "ÎÎµÎ¼Î­Î±": "ğŸ¥˜ ÎšÎ¿ÎºÎºÎ¹Î½Î¹ÏƒÏ„ÏŒ, ğŸ” Burger, ğŸ ÎœÎ±ÎºÎ±ÏÏŒÎ½Î¹Î± Î¼Îµ ÎºÎ¹Î¼Î¬",
        "Syrah": "ğŸ– BBQ, ğŸ¥“ Î Î¹ÎºÎ¬Î½Ï„Î¹ÎºÎ± Î‘Î»Î»Î±Î½Ï„Î¹ÎºÎ¬, ğŸ¥© Ribeye",
        "Merlot": "ğŸ— ÎšÎ¿Ï„ÏŒÏ€Î¿Ï…Î»Î¿, ğŸ Î–Ï…Î¼Î±ÏÎ¹ÎºÎ¬, ğŸ§€ Î•Î»Î±Ï†ÏÎ¹Î¬ Î¤Ï…ÏÎ¹Î¬",
        "Cabernet": "ğŸ¥© ÎœÏ€ÏÎ¹Î¶ÏŒÎ»Î±, ğŸ– Î‘ÏÎ½Î¯, ğŸ§€ Î Î±Î»Î±Î¹Ï‰Î¼Î­Î½Î± Î¤Ï…ÏÎ¹Î¬",

        # --- Î›Î•Î¥ÎšÎ‘ ---
        "Î‘ÏƒÏÏÏ„Î¹ÎºÎ¿": "ğŸŸ Î¨Î¬ÏÎ¹ Î£Ï‡Î¬ÏÎ±Ï‚, ğŸ‹ Î›ÎµÎ¼Î¿Î½Î¬Ï„Î¿ Î‘ÏÎ½Î¯, ğŸ™ Î§Ï„Î±Ï€ÏŒÎ´Î¹",
        "Î£Î±Î½Ï„Î¿ÏÎ¯Î½Î·": "ğŸŸ Î¨Î¬ÏÎ¹ Î£Ï‡Î¬ÏÎ±Ï‚, ğŸ‹ Î›ÎµÎ¼Î¿Î½Î¬Ï„Î¿ Î‘ÏÎ½Î¯, ğŸ™ Î§Ï„Î±Ï€ÏŒÎ´Î¹",
        "ÎœÎ±Î»Î±Î³Î¿Ï…Î¶Î¹Î¬": "ğŸ¥— Î ÏÎ¬ÏƒÎ¹Î½ÎµÏ‚ Î£Î±Î»Î¬Ï„ÎµÏ‚, ğŸ Î–Ï…Î¼Î±ÏÎ¹ÎºÎ¬ Pesto, ğŸ¥§ Î Î¯Ï„ÎµÏ‚",
        "ÎœÎ¿ÏƒÏ‡Î¿Ï†Î¯Î»ÎµÏÎ¿": "ğŸ£ Sushi, ğŸ¥¢ Î‘ÏƒÎ¹Î±Ï„Î¹ÎºÎ® ÎšÎ¿Ï…Î¶Î¯Î½Î±, ğŸ Î¦ÏÎ¿ÏÏ„Î±",
        "Chardonnay": "ğŸ¦ Î‘ÏƒÏ„Î±ÎºÏŒÏ‚, ğŸ— Î¨Î·Ï„ÏŒ ÎšÎ¿Ï„ÏŒÏ€Î¿Ï…Î»Î¿, ğŸ ÎšÎ±ÏÎ¼Ï€Î¿Î½Î¬ÏÎ±",
        "Sauvignon": "ğŸ¥’ Î£Ï€Î±ÏÎ¬Î³Î³Î¹Î±, ğŸ§€ ÎšÎ±Ï„ÏƒÎ¹ÎºÎ¯ÏƒÎ¹Î¿ Î¤Ï…ÏÎ¯, ğŸ¥— Î£Î±Î»Î¬Ï„ÎµÏ‚",
        "Vidiano": "ğŸŸ Î¨Î¬ÏÎ¹, ğŸ– Î›ÎµÏ…ÎºÏŒ ÎšÏÎ­Î±Ï‚, ğŸ ÎšÏÎ¹Î¸Î±ÏÏŒÏ„Î¿",

        # --- Î¡ÎŸÎ–Î• ---
        "ÎÎ¹Î½ÏŒÎ¼Î±Ï…ÏÎ¿": "ğŸ¥˜ Î›Î±Î´ÎµÏÎ¬, ğŸ… Î“ÎµÎ¼Î¹ÏƒÏ„Î¬, ğŸ Î–Ï…Î¼Î±ÏÎ¹ÎºÎ¬ Î¼Îµ ÏƒÎ¬Î»Ï„ÏƒÎ±",  # (Î¡Î¿Î¶Î­ ÎµÎºÎ´Î¿Ï‡Î®)
    }

    print("ğŸ§  Starting Intelligent Tagging (Pro Mode)...")
    total_updates = 0

    for keyword, tags in smart_rules.items():
        # Î¨Î¬Ï‡Î½Î¿Ï…Î¼Îµ Î±Î½ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Ï„Î¿Ï… ÎºÏÎ±ÏƒÎ¹Î¿Ï Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î· Î»Î­Î¾Î· ÎºÎ»ÎµÎ¹Î´Î¯
        # Î¤Î¿ % ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ "Î¿Ï„Î¹Î´Î®Ï€Î¿Ï„Îµ Ï€ÏÎ¹Î½ Î® Î¼ÎµÏ„Î¬"
        query = """
        UPDATE wine_intelligence 
        SET food_pairing = ? 
        WHERE wine_name LIKE ?
        """
        search_term = f"%{keyword}%"

        cursor.execute(query, (tags, search_term))
        count = cursor.rowcount

        if count > 0:
            print(f"   ğŸ· Î’ÏÎ­Î¸Î·ÎºÎ±Î½ {count} ÎºÏÎ±ÏƒÎ¹Î¬ Î¼Îµ '{keyword}' -> Updated!")
            total_updates += count

    conn.commit()
    conn.close()

    print("------------------------------------------------")
    print(f"ğŸš€ Î•Ï„Î¿Î¹Î¼Î¿! Î•Î¾ÎµÎ¹Î´Î¹ÎºÎµÏÏ„Î·ÎºÎ±Î½ {total_updates} ÎµÏ„Î¹ÎºÎ­Ï„ÎµÏ‚.")
    print("ÎœÎ·Î½ Î¾ÎµÏ‡Î¬ÏƒÎµÎ¹Ï‚ Î½Î± ÎºÎ¬Î½ÎµÎ¹Ï‚ Refresh ÏƒÏ„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®!")


if __name__ == "__main__":
    advanced_tagging()